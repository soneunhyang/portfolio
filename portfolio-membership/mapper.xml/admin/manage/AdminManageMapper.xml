<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks54team01.admin.manage.mapper.AdminManageMapper">

	<update id="modifyAdminInfo" parameterType="Admin">
  		/* 관리자정보 수정 */
		UPDATE manager
		<set>
			<if test="managerName != null and managerName != ''">
				manager_nm = #{managerName}, 			
			</if>
			<if test="managerPhone != null and managerPhone != ''">
				manager_phone = #{managerPhone}, 			
			</if>
				revision_date = CURDATE()
		</set>		 
		WHERE 
			manager_id = #{memberId};
  	</update>


	<update id="modifyCommonInfo" parameterType="Admin">
  		/* 공통정보 수정 */
		UPDATE members
		<set>
			<if test="memberPw != null and memberPw != ''">
				members_pw = #{memberPw},
			</if>
				state_transition_date = CURDATE()	
		</set>		 
		WHERE 
			members_id = #{memberId};
  	</update>

	<select id="findAdminById" resultType="Admin">
	/* 관리자 조회(로그인) */
	    SELECT 
	        memberId,
	        memberPw,
	        memberType,
	        managerName,
	        managerGender,
	        managerPhone,
	        managerBrdt,
	        memberDormantStatus,
	        memberWithdrawStatus,
	        memberStateTransitionDate
	    FROM 
	    	manager_info_view
	    WHERE 
	    	memberId = #{memberId}
	</select>
	
</mapper>
